----------------------------iPAY---------------------------------------
require("WBC_DO_OBJ_WBC_MCR_CHIP")
require("WBC_DO_OBJ_WBC_SWIPE_INSERT")
require("WBC_EMV_INIT")
require("WBC_CHECK_LOGON_OK")
require("WBC_CHECK_REV_OK")
require("WBC_TXN_ALLOWED")
require("WBC_DO_OBJ_PRCHAMOUNT")
require("WBC_DO_OBJ_SWIPECARD")
require("WBC_DO_OBJ_CARDENTRY")
require("WBC_DO_OBJ_LUHNERROR")
require("WBC_DO_OBJ_CARD_EXPIRY")
require("WBC_DO_OBJ_INVMONTH")
require("WBC_DO_OBJ_CCV")
require("WBC_GET_CARDINFO")
require("WBC_DO_OBJ_ACCOUNT")
require("WBC_DO_OBJ_PIN")
require("WBC_DO_OBJ_TRANTIMEOUT")
require("WBC_DO_OBJ_OFFLINE_CHECK")
require("WBC_DO_OBJ_TRANSDIAL")
require("WBC_DO_OBJ_TRANSSTART")
require("WBC_DO_OBJ_SAF_REV_START")
require("WBC_SAF_REV_CHECK")
require("WBC_DO_OBJ_SAF_REV_SEND")
require("WBC_PREPARE_TXN_REQ")
require("WBC_DO_OBJ_TXN_REQ")
require("WBC_DO_OBJ_TXN_RESP")
require("WBC_DO_OBJ_TXN_OK")
require("WBC_UPDATE_TOTAL")
require("WBC_DO_OBJ_TXN_SIG")
require("WBC_DO_OBJ_TXN_SECOND_COPY")
require("WBC_COPY_TXN_TO_REVERSAL")
require("WBC_DO_OBJ_TXN_NOK")
require("WBC_DO_OBJ_TXN_NOK_PRINT")
require("WBC_DO_OBJ_LOGON_INIT")
require("WBC_DO_OBJ_LOGON_START")
require("WBC_DO_OBJ_LOGON_REQ")
require("WBC_DO_OBJ_LOGON_RESP")
require("WBC_DO_OBJ_LOGON_OK")
require("WBC_DO_OBJ_LOGON_NOK")
require("WBC_DO_OBJ_EMV_ERROR")
require("WBC_TCPCONNECT")
require("WBC_MSG_ENC")
require("WBC_TCPSEND")
require("WBC_TCPRECV")
require("WBC_LOCALERRORCODE")
require("WBC_WBC_ERRORCODE")
require("WBC_JSONTABLE2STRING")
require("WBC_HOSTTAG_PROCESS")
require("WBC_SETTLEDATE_UPDATE")
require("WBC_SESSIONKEY_UPDATE")
require("WBC_DO_OBJ_SHFT_RESET")
require("WBC_DO_OBJ_TXN_FINISH")
require("WBC_GET_EMV_PRINT_TAGS")
require("WBC_GET_IPAY_PRINT_NOK")
require("WBC_GET_IPAY_PRINT")
require("WBC_GET_NEXT_ID")
require("WBC_FUNCKEYMENU")
require("WBC_DO_OBJ_SWDOWNLOAD")
require("WBC_DO_OBJ_CLEAR_SAF")
require("WBC_DO_OBJ_UPLOAD_SAF")
require("WBC_DO_OBJ_TXN_RESET_MEMORY")
require("WBC_GET_VALUE_FROM_TLVS")
require("WBC_CHECKPRINT")
require("WBC_DO_OBJ_GPRS_REGISTER")
require("WBC_SWIPECHECK")
require("WBC_BIT")
require("WBC_HASBIT")
require("WBC_DEBUGPRINT")
callback.func_func = funckeymenu
if not callback.chip_func then callback.chip_func = do_obj_wbc_mcr_chip end
if not callback.mcr_func then callback.mcr_func = do_obj_wbc_mcr_chip end
if terminal.FileExist("REV_TODO") then
  local revmin,revnext = terminal.GetArrayRange("REVERSAL")
  local revfile = "REVERSAL"..revnext
  terminal.FileCopy( "REV_TODO", revfile)
  terminal.SetArrayRange("REVERSAL","",revnext+1)
  terminal.FileRemove("REV_TODO")
end
config.msgenc = "1" --boyang TESTING
saf_rev_check()
